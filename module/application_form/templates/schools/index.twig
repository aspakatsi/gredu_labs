{% extends "layout.twig" %}

{% macro input(name, label, value, type, attributes) %}
<div class="form-group">
    <label class="control-label hidden-xs hidden-sm col-md-3" for="el-{{ name }}">{{ label|raw }}</label>
    <div class="col-xs-12 col-sm-12 col-md-9">
        <input placeholder="{{ label|striptags }}" class="form-control input-sm"
            type="{{ type|default('text') }}" name="{{ name }}"
            id="el-{{ name }}" value="{{ value|default('')|raw }}"
        {% for attr_name, attr_value in attributes|default({}) %}
            {{ attr_name }}="{{ attr_value }}"
        {% endfor %}>
    </div>
</div>
{% endmacro %}

{% macro checkbox(name, label, checked, attributes) %}
<div class="form-group">
    <div class="col-xs-12 col-sm-12 col-md-9 col-md-offset-3">
        <div class="checkbox">
            <label for="el-{{ name }}">
                <input type="checkbox" name="{{ name }}" id="el-{{ name }}" 
                    {% for attr_name, attr_value in attributes|default({}) %}
                        {{ attr_name }}="{{ attr_value }}"
                    {% endfor %}
                    {% if checked %} checked{% endif %} value="asdasdasd">
                {{ label|raw }}
            </label>
        </div>
    </div>
</div>
{% endmacro %}

{% macro file(name, label, value, attributes) %}
<div class="form-group">
    <label class="control-label hidden-xs hidden-sm col-md-3" for="el-{{ name }}">{{ label|raw }}</label>
    <div class="col-xs-12 col-sm-12 col-md-9">
        <div class="input-group">
            <span class="input-group-btn">
                <span class="btn btn-default btn-file">
                    Επιλέξτε&hellip; <input type="file" multiple name="{{ name }}" id="el-{{ name }}">
                </span>
            </span>
            <input type="text" class="form-control" readonly placeholder="{{ label|striptags }}"
            {% for attr_name, attr_value in attributes|default({}) %}
                {{ attr_name }}="{{ attr_value }}"
            {% endfor %}>
            
            <span class="input-group-btn">
                <span class="btn btn-default btn-file-remove">
                    <i class="fa fa-remove"></i>
                </span>
            </span>
        </div>
        {% if value %}
        <div class="pull-right uploaded btn-group btn-group-sm" data-href="{{ value }}">
            <a href="#" target="_blank" class="btn-download btn bnt-link btn-sm">
                <i class="fa fa-download"></i> Λήψη</a>
            <a href="#" class="btn-remove btn bnt-link btn-sm text-danger">
                <i class="fa fa-remove"></i> Διαγραφή</a>
        </div>
        {% endif %}       
    </div>
</div>
{% endmacro %}

{% macro select(name, label, options, selected, attributes) %}
<div class="form-group">
    <label class="control-label hidden-xs hidden-sm col-md-3" for="el-{{ name }}">{{ label|raw }}</label>
    <div class="col-xs-12 col-sm-12 col-md-9">
        <select class="form-control input-sm" name="{{ name }}" id="el-{{ name }}"
        {% for attr_name, attr_value in attributes|default({}) %}
            {{ attr_name }}="{{ attr_value }}"
        {% endfor %}>
        {% set multi = attributes.multiple is defined %}
        {% if multi %}
            <optgroup label="{{ label|striptags }}">
        {% endif %}
            {% if not multi %}
                <option value="" disabled{% if selected is empty %} selected{% endif %}>{{ label|striptags }}</option>
            {% endif %}
            {% for option in options %}
                <option value="{{ option.value|e }}"{% if selected == option.value %} selected{% endif %}>
                    {{ option.label }}
                </option>
            {% endfor %}
        {% if multi %}
            </optgroup>
        {% endif %}
        </select>
    </div>
</div>
{% endmacro %}

{% macro select_year(name, label, selected, start, attributes) %}
    <div class="form-group">
    <label class="control-label hidden-xs hidden-sm col-md-3" for="el-{{ name }}">{{ label|raw }}</label>
    <div class="col-xs-12 col-sm-12 col-md-9">
        <select class="form-control input-sm" name="{{ name }}" id="el-{{ name }}"
        {% for attr_name, attr_value in attributes|default({}) %}
            {{ attr_name }}="{{ attr_value }}"
        {% endfor %}>
            <option value="" disabled{% if selected is empty %} selected{% endif %}>{{ label|striptags }}</option>
            {% for option in range("now"|date("Y"), start|default(1980)) %}
            <option value="{{ option|e }}"{% if selected == option %} selected{% endif %}>
                {{ option }}
            </option>
            {% endfor %}
        </select>
    </div>
</div>
{% endmacro %}

{% macro text(name, label, value, attributes) %}
    <div class="form-group">
        <label for="el-{{ name }}" class="col-xs-12 pull-left">
            {{ label|e }}
        </label>
        <div class="col-xs-12">
            <textarea id="el-{{ name }}" name="{{ name }}" class="form-control" placeholder="{{ label|striptags }}"
        {% for attr_name, attr_value in attributes|default({}) %}
            {{ attr_name }}="{{ attr_value }}"
        {% endfor %}>
                {{ value|striptags }}
            </textarea>
        </div>
    </div>
{% endmacro %}

{% block content %}
    <div id="school">
        <h1>
        {% block schoolTitle %}
            {{ school.name }}
        {% endblock %}
        </h1>
        <ul class="nav nav-tabs">
            {% for page in nav('main').school.pages %}
            <li role="presentation" class="{% if page.active %}active{% endif %}">
                <a href="{{ page.href }}" {% if page.id %}id="{{ page.id }}"{% endif %} title="{{ page.label }}">
                    <i class="visible-xs fa fa-{{ page.icon }}"></i>
                    <span class="hidden-xs">{{ page.label }}</span>
                </a>
            </li>
            {% endfor %}
            {% block navItems %}{% endblock %}
        </ul>
        <br>
        <div class="row">
            <div class="col-xs-12 school-container">
                {% block schoolContent %}
                <div id="school-info">
                    <p class="col-md-12">
                        Σε αυτή την καρτέλα θα καταχωρήσετε πληροφορίες που 
                        αφορούν στο σχολείο σας, όπως τους εκπαιδευτικούς 
                        που θα ασχοληθούν με την υλοποίηση του έργου, 
                        τους χώρους που χρησιμοποιείτε για χρήση ΤΠΕ ή 
                        τους επιπλέον χώρους που θα επιθυμούσατε να 
                        χρησιμοποιήσετε για χρήση ΤΠΕ, τον εξοπλισμό 
                        ΤΠΕ που διαθέτει το σχολείο και τον τρόπο που τον 
                        χρησιμοποιείτε κλπ.
                    </p>
                    <div class="col-md-4">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4>Εκπαιδευτικοί</h4>
                            </div>
                            <div class="panel-body">
                                <dl>
                                    <dt>Διευθυντής</dt>
                                    <dd>{{ staff.principle }}</dd>
                                    <dt>Εκπαιδευτικοί</dt>
                                    {% for teacher in staff.teachers %}
                                        <dd>{{ teacher }}</dd>
                                    {% endfor %}
                                </dl>
                            </div>
                            <div class="panel-footer text-center">
                                <a class="btn btn-sm btn-primary" href="{{ path_for('school.staff') }}#add">Καταχώρηση εκπαιδευτικού</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4>Καταχωρημένοι χώροι</h4>
                            </div>
                            <div class="panel-body">
                                <ul>
                                    {% for lab in labs %}
                                    <li>{{ lab.name }}</li>
                                    {% endfor %}
                                </ul>
                            </div>
                            <div class="panel-footer text-center">
                                <a class="btn btn-sm btn-primary" href="{{ path_for('school.labs') }}#add">Καταχώρηση χώρου</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4>Εξοπλισμός</h4>
                            </div>
                            <div class="panel-body">
                                <dl class="dl-horizontal">
                                    {% for asset in assets %}
                                        <dt>{{ asset.category }}</dt>
                                        <dd>{{ asset.count }}<dd>
                                    {% endfor %}
                                </dl>
                            </div>
                            <div class="panel-footer text-center">
                                <a class="btn btn-sm btn-primary" href="{{ path_for('school.assets') }}#add">Καταχώρηση εξοπλισμού</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                         <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4>Στοιχεία αίτησης</h4>
                            </div>
                            <div class="panel-body">
                                {% if appForm %}
                                    <div class="row">
                                        <dl class="col-sm-12 col-md-6 dl-horizontal">
                                            <dt>A/A αίτησης</dt>
                                            <dd>{{ appForm.id }}</dd>
                                            <dt>Ημερ. υποβολής</dt>
                                            <dd>{{ appForm.submitted|date('d/m/Y') }}<dd>
                                            <dt>Σχολείο</dt>
                                            <dd>{{ school.name }}</dd>
                                            <dt>Κωδικός Υπουργείου</dt>
                                            <dd>{{ school.registry_no }}<dd>
                                        </dl>
                                        <dl class="col-sm-12 col-md-6 dl-horizontal">
                                            <dt>Αίτημα του σχολείου για</dt>
                                            <dd>{{ appForm.apply_for }}</dd>
                                            <dt>Ύπαρξη - προοπτική αίθουσας για δημιουργία νέου εργαστηρίου</dt>
                                            <dd>{{ appForm.new_lab_perspective }}<dd>
                                            <dt>Σχόλια/Παρατηρήσεις</dt>
                                            <dd>{{ appForm.comments }}</dd>
                                        </dl>

                                    </div>
                                    <h5>Αιτούμενος εξοπλισμός</h5>
                                    <dl class="dl-horizontal">
                                    {% for item in appForm.items %}
                                        <dt>{{ item.category }}</dt>
                                        <dd>{{ item.count }}<dd>
                                    {% endfor %}
                                    </dl>
                                {% else %}        
                                    <p>Δεν έχετε υποβάλει αίτηση ακόμα.</p>
                                {% endif %}
                            </div>
                            <div class="panel-footer text-center">
                                {% if not appForm %}
                                    <a class="btn btn-sm btn-primary" href="{{ path_for('application_form') }}">Υποβολή αίτησης</a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endblock %}
            </div>
        </div>
    </div>
{% endblock %}
{% block inlinejs %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.2.3/backbone-min.js"></script>
    <script type="text/javascript" src="{{ base_url }}/js/schools/index.js"></script>
{% endblock %}